{% extends "base.html" %}

{% block title %}{{ 'Edit' if mapping else 'Add' }} Odoo Field Mapping{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row">
        <div class="col-lg-8 offset-lg-2">
            <div class="card shadow">
                <div class="card-header">
                    <h4>{{ 'Edit' if mapping else 'Add' }} Odoo Field Mapping</h4>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('admin.edit_odoo_mapping', mapping_id=mapping.id) if mapping else url_for('admin.add_odoo_mapping') }}">
                        <div class="form-group mb-3">
                            <label for="employee_field">Employee Field</label>
                            <input type="text" class="form-control" id="employee_field" name="employee_field" 
                                value="{{ mapping.employee_field if mapping else '' }}" required>
                            <small class="form-text text-muted">The field name in the Employee model</small>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="odoo_field">Odoo Field</label>
                            <select class="form-select" id="odoo_field" name="odoo_field" required>
                                {% if odoo_fields %}
                                    {% for field in odoo_fields %}
                                        <option value="{{ field }}" 
                                            {% if mapping and mapping.odoo_field == field %}selected{% endif %}>
                                            {{ field }}
                                        </option>
                                    {% endfor %}
                                {% else %}
                                    <option value="">No fields available - connect to Odoo first</option>
                                {% endif %}
                            </select>
                            <small class="form-text text-muted">The field name in Odoo's hr.employee table</small>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="field_type">Field Type</label>
                            <select class="form-select" id="field_type" name="field_type" required>
                                <option value="text" {% if mapping and mapping.field_type == 'text' %}selected{% endif %}>Text</option>
                                <option value="number" {% if mapping and mapping.field_type == 'number' %}selected{% endif %}>Number</option>
                                <option value="date" {% if mapping and mapping.field_type == 'date' %}selected{% endif %}>Date</option>
                                <option value="boolean" {% if mapping and mapping.field_type == 'boolean' %}selected{% endif %}>Boolean</option>
                            </select>
                        </div>
                        
                        <div class="form-group mb-3">
                            <label for="default_value">Default Value (optional)</label>
                            <input type="text" class="form-control" id="default_value" name="default_value" 
                                value="{{ mapping.default_value if mapping else '' }}">
                            <small class="form-text text-muted">Default value if Odoo field is empty</small>
                        </div>
                        
                        <div class="form-check mb-3">
                            <input type="checkbox" class="form-check-input" id="is_required" name="is_required" 
                                {% if mapping and mapping.is_required %}checked{% endif %}>
                            <label class="form-check-label" for="is_required">Required Field</label>
                        </div>
                        
                        <div class="form-check mb-3">
                            <input type="checkbox" class="form-check-input" id="is_active" name="is_active" 
                                {% if not mapping or mapping.is_active %}checked{% endif %}>
                            <label class="form-check-label" for="is_active">Active</label>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-between">
                            <button type="submit" class="btn btn-primary">
                                {{ 'Update' if mapping else 'Add' }} Mapping
                            </button>
                            <a href="{{ url_for('admin.odoo_config') }}" class="btn btn-secondary">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
